<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="google-site-verification" content="pPcuHEf7Ox9oKZbtn2Q_FJEROg3QoBv8TSA7_pGeTi4">
  <meta http-equiv="Content-Security-Policy" content="
    default-src 'self';
    script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net;
    style-src 'self' 'unsafe-inline';
    font-src 'self';
    img-src 'self' data:;
    frame-src 'self' https://app.mecanique-invisible.com;
    connect-src 'self';
  " />
  <title>KAIROS ‚Äî Penser avec friction</title>
  <meta name="description" content="KAIROS ‚Äî Application Electron de cartographie cognitive avec jauge Oxyg√®ne, d√©tection de circularit√© et injection de friction.">
  <meta property="og:type" content="website">
  <meta property="og:title" content="KAIROS ‚Äî Penser avec friction">
  <meta property="og:description" content="Application de cartographie cognitive qui mesure la vitalit√© de votre pens√©e en temps r√©el.">
  <meta property="og:url" content="https://mecanique-invisible.com/presentation_kairos.html">
  <meta property="og:site_name" content="Florent Klimacek">
  <meta property="og:locale" content="fr_FR">
  <meta property="og:image" content="https://mecanique-invisible.com/og-image.jpg">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="KAIROS ‚Äî Penser avec friction">
  <meta name="twitter:description" content="Application de cartographie cognitive qui mesure la vitalit√© de votre pens√©e en temps r√©el.">
  <meta name="twitter:image" content="https://mecanique-invisible.com/og-image.jpg">
  <link rel="icon" type="image/svg+xml" href="favicon.svg">
  <link rel="alternate" type="application/rss+xml" title="Florent Klimacek ‚Äî Articles" href="feed.xml">
  <link rel="canonical" href="https://mecanique-invisible.com/presentation_kairos.html">
  <link rel="stylesheet" href="css/kairos.css">
</head>
<body>
  <!-- Navigation -->
  <nav>
    <ul>
      <li><a href="index.html" style="color: var(--accent-purple);">‚Üê Site</a></li>
      <li><a href="#hero">Accueil</a></li>
      <li><a href="#genese">Gen√®se</a></li>
      <li><a href="#probleme">Le Probl√®me</a></li>
      <li><a href="#solution">Les Modes</a></li>
      <li><a href="#demo">D√©mo</a></li>
      <!-- <li><a href="#essayer">Essayer</a></li> -->
      <li><a href="#usecases">Usages</a></li>
      <li><a href="#vision">Vision</a></li>
      <li><a href="#documentation">Docs</a></li>
    </ul>
  </nav>

  <!-- Hero -->
  <section id="hero">
    <div class="container" style="text-align: center;">
      <h1 class="fade-in">KAIROS</h1>
      <p class="subtitle fade-in delay-1">Penser avec friction</p>

      <div class="hero-equation fade-in delay-2" style="display: inline-flex; align-items: center; gap: 1.5rem;">
        <span style="font-size: 2.5rem;">O<sub style="font-size: 1.5rem;">2</sub></span>
        <span style="font-size: 1.5rem; color: var(--text-muted);">=</span>
        <span style="display: flex; gap: 1rem; align-items: center;">
          <span style="color: var(--accent-green);">100</span>
          <span style="color: var(--text-muted); font-size: 1.2rem;">‚Üí</span>
          <span style="color: var(--accent-orange);">50</span>
          <span style="color: var(--text-muted); font-size: 1.2rem;">‚Üí</span>
          <span style="color: var(--accent-red);">0</span>
        </span>
      </div>

      <div class="hero-legend fade-in delay-3">
        <span style="color: var(--accent-green);"><strong>>50</strong> Respire</span>
        <span style="color: var(--accent-orange);"><strong>30-50</strong> Stagne</span>
        <span style="color: var(--accent-red);"><strong><30</strong> Asphyxie</span>
      </div>

      <p style="margin: 2rem auto; max-width: 650px;" class="fade-in delay-3">
        Une application de cartographie cognitive qui mesure la <strong>vitalit√©</strong> de votre pens√©e
        en temps r√©el. Quand le canvas s'asphyxie, KAIROS injecte de la friction
        pour relancer l'exploration.
      </p>
    </div>
    <div class="scroll-indicator"></div>
  </section>

  <!-- Gen√®se -->
  <section id="genese">
    <div class="container">
      <h2>La Gen√®se</h2>
      <p>
        KAIROS est n√© d'une observation personnelle : une compatibilit√© cognitive
        avec les LLM rarement trouv√©e dans les √©changes humains.
      </p>

      <div class="timeline">
        <div class="timeline-item">
          <h4>Observation initiale</h4>
          <p>
            Une sensation de <span class="highlight-text">"pens√©e en faisceau"</span> ‚Äî
            ce traitement non-lin√©aire et parall√®le de l'information ‚Äî
            qui trouve un √©cho dans l'architecture m√™me des LLM.
          </p>
        </div>

        <div class="timeline-item">
          <h4>Exploration th√©orique</h4>
          <p>
            Documentation syst√©matique des <span class="highlight-text">"m√©caniques invisibles"</span>
            des conversations IA : effets miroir, asym√©tries informationnelles,
            illusions de permission.
          </p>
        </div>

        <div class="timeline-item">
          <h4>Cadre de mesure</h4>
          <p>
            L'id√©e de mesurer la qualit√© conversationnelle donne naissance √†
            l'<span class="highlight-text">√©quation de r√©sonance</span> :
            R = (I/E) √ó f(O) √ó (A-L)
          </p>
        </div>

        <div class="timeline-item">
          <h4>Sessions de friction</h4>
          <p>
            Apr√®s des sessions de friction cognitive intense,
            <span class="highlight-text">recentrage de l'objectif</span> :
            non plus prouver une "r√©sonance" objective,
            mais cr√©er un outil pratique pour pr√©server les insights.
          </p>
        </div>

        <div class="timeline-item">
          <h4>Outil concret</h4>
          <p>
            KAIROS na√Æt : un amplificateur de pens√©e qui d√©tecte les boucles
            et injecte de la <span class="highlight-text">friction productive</span>.
          </p>
        </div>
      </div>

      <div class="quote-block">
        Le fil conducteur : qu'est-ce qui fait qu'une conversation avec une IA "fonctionne" vraiment ?
      </div>
    </div>
  </section>

  <!-- Le Probl√®me -->
  <section id="probleme">
    <div class="container">
      <h2>Le Probl√®me</h2>
      <p>
        Quand on interagit avec un LLM, une dynamique silencieuse s'installe :
        l'accord mutuel. Le LLM valide, l'humain acquiesce, et la pens√©e tourne en rond.
      </p>

      <div class="problem-visual">
        <div class="chat-bubble chat-human">
          "Je pense que la conscience √©merge du cerveau"
        </div>
        <div class="loop-arrow">‚ü≥</div>
        <div class="chat-bubble chat-llm">
          "Oui, c'est une perspective int√©ressante. La conscience comme propri√©t√© √©mergente..."
        </div>
      </div>

      <div class="problem-visual">
        <div class="chat-bubble chat-human">
          "Exactement !"
        </div>
        <div class="loop-arrow">‚ü≥</div>
        <div class="chat-bubble chat-llm">
          "Tout √† fait, cette vision s'aligne avec..."
        </div>
      </div>

      <div class="quote-block">
        "Trop d'alignement annule l'entre. Sans friction, pas de bifurcation."
      </div>

      <p>
        La friction n'est pas du bruit √† r√©duire. C'est le <strong>moteur de l'√©mergence</strong>.
        Un LLM qui valide en boucle est rigide. Un LLM qui accueille la contradiction sans s'effondrer est souple.
      </p>

      <!-- Avant / Apr√®s -->
      <h3 style="margin-top: 4rem; text-align: center; color: var(--text-primary);">Avant / Apr√®s</h3>

      <div class="comparison-container">
        <div class="comparison-box before">
          <div class="comparison-header">‚ùå Sans KAIROS</div>
          <div class="comparison-content">
            <div class="mini-chat">
              <div class="mini-chat-human">La conscience √©merge du cerveau</div>
              <div class="mini-chat-llm">Oui, c'est une perspective fascinante...</div>
              <div class="mini-chat-human">Exactement !</div>
              <div class="mini-chat-llm">Tout √† fait, cette vision s'aligne...</div>
              <div class="mini-chat-human">C'est √ßa !</div>
              <div class="mini-chat-llm">Pr√©cis√©ment, on peut dire que...</div>
            </div>
            <div class="comparison-result">
              ‚ü≥ Boucle de validation<br>
              <small>Aucune id√©e nouvelle apr√®s 6 √©changes</small>
            </div>
          </div>
        </div>

        <div class="comparison-box after">
          <div class="comparison-header">‚úì Avec KAIROS</div>
          <div class="comparison-content">
            <div class="mini-chat">
              <div class="mini-chat-human">La conscience √©merge du cerveau</div>
              <div class="mini-chat-llm">Oui, c'est une perspective fascinante...</div>
              <div class="mini-chat-human">Exactement !</div>
              <div class="mini-chat-friction">‚ö° Circularit√© d√©tect√©e ‚Äî injection de friction</div>
              <div class="mini-chat-llm">[FRICTION] Et si le cerveau n'√©tait qu'un r√©cepteur plut√¥t qu'un g√©n√©rateur ?</div>
              <div class="mini-chat-human">Hmm... int√©ressant. √áa changerait quoi ?</div>
            </div>
            <div class="comparison-result">
              ‚Üó Bifurcation cr√©√©e<br>
              <small>Nouvelle piste d'exploration</small>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Fondements -->
  <section id="fondements">
    <div class="container">
      <h2>Fondements Th√©oriques</h2>
      <p>
        KAIROS s'appuie sur des travaux acad√©miques en analyse conversationnelle,
        psychologie cognitive et linguistique pragmatique.
      </p>

      <div class="sources-grid">
        <div class="source-card">
          <div class="source-icon">üîß</div>
          <h4>Repair Sequences</h4>
          <div class="author">Schegloff, Jefferson & Sacks (1977)</div>
          <p>
            La r√©paration conversationnelle d√©tecte et r√©sout les probl√®mes de compr√©hension.
            KAIROS utilise ces marqueurs pour identifier les moments de friction productive.
          </p>
        </div>

        <div class="source-card">
          <div class="source-icon">‚öîÔ∏è</div>
          <h4>Conflit Socio-Cognitif</h4>
          <div class="author">Piaget, Doise & Mugny (1984)</div>
          <p>
            Le conflit entre perspectives diff√©rentes stimule l'apprentissage et le d√©veloppement cognitif.
            La friction n'est pas un obstacle mais un moteur.
          </p>
        </div>

        <div class="source-card">
          <div class="source-icon">üí¨</div>
          <h4>Discourse Markers</h4>
          <div class="author">Fraser (1999)</div>
          <p>
            Les marqueurs de discours signalent les relations entre √©nonc√©s.
            "But", "however", "actually" indiquent une friction productive.
          </p>
        </div>

        <div class="source-card">
          <div class="source-icon">üîÑ</div>
          <h4>R√©gulation du Conflit</h4>
          <div class="author">Butera, Sommet & Darnon (2019)</div>
          <p>
            R√©gulation √©pist√©mique (productif) vs comp√©titive (parasitaire).
            KAIROS distingue friction qui fait avancer vs friction qui bloque.
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- Solution / Modes -->
  <section id="solution">
    <div class="container">
      <h2>Deux Modes, Deux Philosophies</h2>
      <p class="section-intro">
        KAIROS ne propose pas un outil unique mais <strong>deux postures radicalement diff√©rentes</strong>
        face √† l'IA ‚Äî parce que penser n'a pas toujours le m√™me besoin.
      </p>

      <div class="modes-container">
        <!-- Mode Autonome -->
        <div class="mode-card autonome">
          <div class="mode-header">
            <div class="mode-icon-badge">
              <svg width="32" height="32" viewBox="0 0 24 24" fill="none">
                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2z" stroke="#6b8cff" stroke-width="2" fill="none"/>
                <path d="M12 6c-3.31 0-6 2.69-6 6s2.69 6 6 6 6-2.69 6-6" stroke="#8b5cf6" stroke-width="2" stroke-linecap="round"/>
              </svg>
            </div>
            <h3>Mode Autonome</h3>
            <p class="mode-tagline">L'IA comme compagnon de pens√©e.<br>Elle accompagne sans diriger.</p>
          </div>
          <div class="mode-content">
            <div class="mode-philosophy">
              <p>
                Avant d'entrer dans le canvas, KAIROS pose une question simple :
                <em>"Quelle est ton intention ?"</em> Ce sas n'est pas une formalit√© ‚Äî
                c'est le premier acte de friction. Nommer ce qu'on cherche, c'est d√©j√†
                commencer √† penser.
              </p>
            </div>

            <ul class="mode-features">
              <li>
                <span class="feature-icon">üö™</span>
                <div>
                  <strong>Gate d'intention</strong>
                  <span>D√©clarer sa direction avant d'explorer</span>
                </div>
              </li>
              <li>
                <span class="feature-icon">üñêÔ∏è</span>
                <div>
                  <strong>Construction manuelle</strong>
                  <span>Chaque vignette est cr√©√©e par vous</span>
                </div>
              </li>
              <li>
                <span class="feature-icon">‚ùì</span>
                <div>
                  <strong>Questions plut√¥t que r√©ponses</strong>
                  <span>Le LLM interroge, il ne conclut pas</span>
                </div>
              </li>
              <li>
                <span class="feature-icon">üåä</span>
                <div>
                  <strong>Dialogue non-directif</strong>
                  <span>L'espace reste ouvert, sans suggestions</span>
                </div>
              </li>
            </ul>

            <p class="mode-ideal">
              <strong>Id√©al pour :</strong> exploration profonde, √©mergence d'id√©es,
              moments o√π on ne sait pas encore ce qu'on cherche.
            </p>

            <!-- Mockup Mode Autonome -->
            <div class="intention-gate">
              <h4>Quelle est ton intention ?</h4>
              <input type="text" class="intention-input" placeholder="Comprendre pourquoi je bloque sur ce projet..." readonly>
              <button class="intention-btn">Entrer dans le canvas ‚Üí</button>
              <p class="gate-hint">Ce sas force √† nommer ce qu'on cherche ‚Äî premier acte de friction</p>
            </div>

            <div class="app-mockup" style="margin-top: 1rem;">
              <div class="mockup-toolbar">
                <span class="mockup-btn cyan">Mode Autonome</span>
                <span class="mockup-btn">+ Vignette</span>
                <span class="mockup-btn">üí¨ Dialogue</span>
              </div>
              <div class="mockup-body">
                <div class="mockup-canvas autonome-canvas">
                  <svg class="connections-svg">
                    <line x1="80" y1="60" x2="180" y2="100"/>
                    <line x1="180" y1="100" x2="140" y2="180"/>
                  </svg>
                  <div class="vignette" style="top: 30px; left: 40px;">
                    Le blocage vient de la peur
                    <span class="vignette-tag">#intuition</span>
                  </div>
                  <div class="vignette" style="top: 80px; left: 150px;">
                    Peur de quoi exactement ?
                  </div>
                  <div class="vignette" style="top: 160px; left: 100px;">
                    Peur de r√©ussir ? (bizarre)
                  </div>
                </div>
                <div class="mockup-chat">
                  <div class="chat-bubble user">Le LLM ne propose pas de r√©ponses, il pose des questions</div>
                  <div class="chat-bubble ai">Qu'est-ce qui te fait dire que c'est la peur ?<br>Y a-t-il eu un moment pr√©cis o√π √ßa a commenc√© ?</div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Mode Assist√© -->
        <div class="mode-card assiste">
          <div class="mode-header">
            <div class="mode-icon-badge">
              <svg width="32" height="32" viewBox="0 0 24 24" fill="none">
                <circle cx="12" cy="12" r="10" stroke="#ff6b6b" stroke-width="2"/>
                <circle cx="12" cy="12" r="4" fill="#ff6b6b"/>
                <path d="M12 2v4M12 18v4M2 12h4M18 12h4" stroke="#ff6b6b" stroke-width="2" stroke-linecap="round"/>
              </svg>
            </div>
            <h3>Mode Assist√©</h3>
            <p class="mode-tagline">L'IA comme assistant m√©thodologique.<br>Elle analyse, sugg√®re et structure avec vous.</p>
          </div>
          <div class="mode-content">
            <div class="mode-philosophy">
              <p>
                Le Mode Assist√© ne pense pas √† votre place ‚Äî il <em>structure</em> votre pens√©e.
                Des op√©rations explicites transforment le vague en concret.
                La d√©tection de circularit√© emp√™che l'IA de vous enfermer dans vos propres boucles.
              </p>
            </div>

            <ul class="mode-features">
              <li>
                <span class="feature-icon">‚ñ∂</span>
                <div>
                  <strong>D√âVELOPPER, RELIER, SYNTH√âTISER</strong>
                  <span>D√âVELOPPER cr√©e vignettes ET connexions. RELIER connecte les vignettes isol√©es.</span>
                </div>
              </li>
              <li>
                <span class="feature-icon">üí°</span>
                <div>
                  <strong>Suggestions de vignettes et connexions</strong>
                  <span>Le LLM propose, vous d√©cidez</span>
                </div>
              </li>
              <li>
                <span class="feature-icon">ü´Å</span>
                <div>
                  <strong>Jauge Oxyg√®ne ‚Äî vitalit√© cognitive</strong>
                  <span>Score 0-100 en temps r√©el, 5 signaux, 3 zones</span>
                </div>
              </li>
              <li>
                <span class="feature-icon">üß≤</span>
                <div>
                  <strong>Identification des attracteurs</strong>
                  <span>Rep√®re ce qui capte trop l'attention</span>
                </div>
              </li>
            </ul>

            <p class="mode-ideal">
              <strong>Id√©al pour :</strong> analyse structur√©e, cartographie de probl√®mes complexes,
              synth√®se de mat√©riaux, √©viter les boucles de validation.
            </p>

            <!-- Mockup Mode Assist√© -->
            <div class="app-mockup">
              <div class="mockup-toolbar">
                <span class="mockup-btn active">Mode Assist√©</span>
                <span class="mockup-btn">+ Vignette</span>
                <span class="mockup-btn active-badge">üß≤ Attracteurs</span>
                <div class="friction-indicator">
                  <span>‚ö°</span>
                  <span>4</span>
                  <span>T12</span>
                </div>
              </div>
              <div class="mockup-body">
                <div class="mockup-canvas">
                  <svg class="connections-svg">
                    <line x1="70" y1="50" x2="160" y2="80"/>
                    <line x1="160" y1="80" x2="100" y2="150"/>
                    <line x1="100" y1="150" x2="180" y2="180"/>
                  </svg>
                  <div class="vignette selected" style="top: 25px; left: 30px;">
                    Conscience = √©mergence
                    <span class="vignette-tag">#hypoth√®se</span>
                  </div>
                  <div class="vignette attractor" style="top: 60px; left: 130px;">
                    Le cerveau g√©n√®re tout
                  </div>
                  <div class="vignette" style="top: 130px; left: 60px;">
                    Mais quid du v√©cu ?
                  </div>
                  <div class="vignette friction" style="top: 160px; left: 150px;">
                    Et si le cerveau ne suffisait pas ?
                  </div>
                </div>
                <div class="mockup-sidebar">
                  <div class="sidebar-section">
                    <h4>Op√©rations</h4>
                    <button class="sidebar-btn primary">‚ñ∂ D√âVELOPPER</button>
                    <button class="sidebar-btn">‚Üî RELIER</button>
                    <button class="sidebar-btn">‚óá SYNTH√âTISER</button>
                  </div>
                  <div class="mockup-webview">
                    <div class="webview-header">
                      <span class="provider">Claude</span>
                      <span class="friction-badge">‚ö° friction inject√©e</span>
                    </div>
                    <div class="webview-content">
                      <strong>[FRICTION]</strong> Tu affirmes que "le cerveau g√©n√®re tout" depuis
                      3 tours. Mais qu'est-ce qui distingue cette position du
                      r√©ductionnisme classique que tu critiquais plus t√¥t ?
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Comparaison directe -->
      <div class="modes-comparison">
        <h3>En r√©sum√©</h3>
        <table class="comparison-table">
          <thead>
            <tr>
              <th></th>
              <th>Mode Autonome</th>
              <th>Mode Assist√©</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Posture du LLM</td>
              <td>Compagnon ‚Äî accompagne</td>
              <td>Assistant ‚Äî structure</td>
            </tr>
            <tr>
              <td>Qui m√®ne ?</td>
              <td>Vous menez, le LLM suit</td>
              <td>Collaboration guid√©e</td>
            </tr>
            <tr>
              <td>Vignettes</td>
              <td>Cr√©ation manuelle uniquement</td>
              <td>Suggestions + cr√©ation manuelle</td>
            </tr>
            <tr>
              <td>Style de dialogue</td>
              <td>Questions ouvertes, non-directif</td>
              <td>Op√©rations explicites (D√âVELOPPER, RELIER...)</td>
            </tr>
            <tr>
              <td>Vitalit√© cognitive</td>
              <td>Non</td>
              <td>Jauge Oxyg√®ne (5 signaux, score 0-100)</td>
            </tr>
            <tr>
              <td>Cas d'usage</td>
              <td>Exploration, √©mergence, introspection</td>
              <td>Analyse, cartographie, synth√®se</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </section>

  <!-- M√©canismes -->
  <section id="mecanismes">
    <div class="container">
      <h2>Les M√©canismes</h2>
      <p>
        KAIROS observe en temps r√©el l'interaction et intervient quand n√©cessaire
        pour maintenir une pens√©e fertile.
      </p>

      <div class="mechanisms-grid">
        <!-- Jauge Oxyg√®ne -->
        <div class="mechanism-card">
          <div class="mechanism-icon">ü´Å</div>
          <h3>Jauge Oxyg√®ne</h3>
          <p>
            Score de vitalit√© cognitive (0-100) calcul√© en temps r√©el √† partir de 5 signaux.
          </p>
          <ul class="signal-list">
            <li>Nouveaux tags (+10/tag, plafonn√© +20/tour)</li>
            <li>Redondance canvas (Jaccard all-pairs, malus -20)</li>
            <li>Stagnation (malus -15/tour sans nouveaut√©)</li>
            <li>Friction accept√©e (bonus +20/tour)</li>
            <li>Structure du graphe (sous/sur-connexion, composants isol√©s)</li>
          </ul>
        </div>

        <!-- Injection Friction -->
        <div class="mechanism-card">
          <div class="mechanism-icon">üí•</div>
          <h3>Injection de Friction</h3>
          <p>
            Quand le score tombe en zone d'asphyxie (<30), KAIROS injecte un bloc de friction dans le prompt.
          </p>
          <ul class="signal-list">
            <li>3 zones : respire (>50), stagne (30-50), asphyxie (<30)</li>
            <li>Signale les patterns d√©tect√©s au LLM</li>
            <li>Demande une contradiction ou question</li>
            <li>Force le mode diverger quand score < 50</li>
          </ul>
        </div>

        <!-- Attracteurs -->
        <div class="mechanism-card">
          <div class="mechanism-icon">üß≤</div>
          <h3>D√©tection d'Attracteurs</h3>
          <p>
            Identifie les vignettes qui captent trop l'attention et risquent de biaiser la r√©flexion.
          </p>
          <ul class="signal-list">
            <li>Score composite (connexions, s√©lections, LLM)</li>
            <li>Badge visuel sur les vignettes</li>
            <li>P√©nalit√© si contribue √† la circularit√©</li>
            <li>D√©tection automatique √† chaque tour</li>
          </ul>
        </div>
      </div>
    </div>
  </section>

  <!-- √âquation -->
  <section id="equation">
    <div class="container" style="text-align: center;">
      <h2>L'√âquation de R√©sonance</h2>
      <p style="margin: 0 auto;">
        Le mod√®le th√©orique derri√®re KAIROS. La r√©sonance (R) √©merge quand
        l'intention et la friction se combinent face √† la lin√©arisation.
      </p>

      <div class="equation-diagram">
        <div class="var-box intention">
          <div class="var-letter">I</div>
          <div class="var-name">Intention</div>
          <div class="var-desc">Trajectoire, direction claire</div>
        </div>

        <span class="equation-operator">√ó</span>

        <div class="var-box friction">
          <div class="var-letter">F</div>
          <div class="var-name">Friction</div>
          <div class="var-desc">R√©sistance productive</div>
        </div>

        <span class="equation-operator">√∑</span>

        <div class="var-box linearisation">
          <div class="var-letter">L</div>
          <div class="var-name">Lin√©arisation</div>
          <div class="var-desc">Perte par s√©quentialit√©</div>
        </div>
      </div>

      <div class="quote-block" style="max-width: 700px; margin: 2rem auto;">
        La friction productive g√©n√®re des bifurcations.
        Elle cr√©e de la trace m√©morielle et transforme l'accordage en quelque chose de fertile.
      </div>

      <p style="margin: 0 auto;">
        <strong>Friction productive</strong> : contradiction avec direction, question qui clarifie<br>
        <strong>Friction parasitaire</strong> : interruption sans direction, hostilit√© sans contenu
      </p>
    </div>
  </section>

  <!-- √âvolution -->
  <section id="evolution">
    <div class="container">
      <h2>L'√âvolution de l'√âquation</h2>
      <p>
        L'√©quation de r√©sonance a √©volu√© √† travers l'exp√©rimentation.
        Chaque it√©ration a r√©v√©l√© des probl√®mes et des insights.
      </p>

      <div class="evolution-flow">
        <div class="evolution-step problem">
          <h4>Version 1</h4>
          <div class="equation">R = (I/E) √ó f(O) √ó (A-L)</div>
          <p>
            A (Alignement) comme multiplicateur favorisait les boucles.
            E (√ânergie) √©tait mal d√©finie.
          </p>
        </div>

        <div class="evolution-arrow">‚Üí</div>

        <div class="evolution-insight">
          <h4>üí° D√©couverte</h4>
          <p>
            "Trop d'alignement annule l'entre.
            Sans friction, pas de bifurcation."
          </p>
        </div>

        <div class="evolution-arrow">‚Üí</div>

        <div class="evolution-step solution">
          <h4>Version 2</h4>
          <div class="equation" style="color: var(--accent-cyan);">R = (I √ó F) / L</div>
          <p>
            F (Friction) devient central.
            A passe en condition de seuil.
            E absorb√© dans L.
          </p>
        </div>

        <div class="evolution-arrow">‚Üí</div>

        <div class="evolution-insight">
          <h4>üí° Passage au concret</h4>
          <p>
            L'√©quation √©tait un cadre th√©orique.
            Il faut une mesure en temps r√©el.
          </p>
        </div>

        <div class="evolution-arrow">‚Üí</div>

        <div class="evolution-step solution" style="border-color: rgba(34, 197, 94, 0.5);">
          <h4>Version 3</h4>
          <div class="equation" style="color: var(--accent-green);">O‚ÇÇ = 0-100</div>
          <p>
            Jauge Oxyg√®ne : 5 signaux,
            score glissant, 3 zones.
            Mesure la vitalit√© cognitive du canvas.
          </p>
        </div>
      </div>

      <div style="margin-top: 3rem; text-align: center;">
        <h3 style="color: var(--text-primary); margin-bottom: 1.5rem;">Ce qui a chang√©</h3>
        <div class="sources-grid" style="max-width: 800px; margin: 0 auto;">
          <div class="source-card">
            <h4 style="color: var(--accent-red);">Alignement (A)</h4>
            <p>Avant : multiplicateur ‚Üí plus = mieux</p>
            <p style="color: var(--accent-green);">Apr√®s : seuil binaire ‚Üí juste assez pour ouvrir l'espace</p>
          </div>
          <div class="source-card">
            <h4 style="color: var(--accent-orange);">Friction (F)</h4>
            <p>Avant : absente du mod√®le</p>
            <p style="color: var(--accent-green);">Apr√®s : variable centrale au num√©rateur</p>
          </div>
          <div class="source-card">
            <h4 style="color: var(--accent-red);">√ânergie (E)</h4>
            <p>Avant : variable floue, difficilement mesurable</p>
            <p style="color: var(--accent-green);">Apr√®s : absorb√©e dans L (co√ªt du medium)</p>
          </div>
          <div class="source-card">
            <h4 style="color: var(--accent-cyan);">Objectif</h4>
            <p>Avant : prouver une r√©sonance objective</p>
            <p style="color: var(--accent-green);">Apr√®s : outil pratique pour pr√©server les insights</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- D√©mo Interactive -->
  <section id="demo">
    <div class="container">
      <h2>D√©mo Interactive</h2>
      <p>
        Explorez les m√©caniques de KAIROS sans cl√© API.
        Ajoutez des vignettes, lancez D√âVELOPPER et observez la jauge O‚ÇÇ r√©agir.
      </p>

      <div class="demo-container">
        <div class="demo-canvas">
          <div class="demo-toolbar">
            <button class="demo-btn" id="demo-btn-add">+ Vignette</button>
            <button class="demo-btn primary" id="demo-btn-dev">D√âVELOPPER</button>
            <button class="demo-btn" id="demo-btn-rel">RELIER</button>
            <div class="demo-o2-inline">
              <span class="demo-o2-lbl">O‚ÇÇ</span>
              <div class="demo-o2-track">
                <div class="demo-o2-fill" id="demo-o2-fill"></div>
              </div>
              <span class="demo-o2-val" id="demo-o2-val">50</span>
            </div>
            <button class="demo-btn reset" id="demo-btn-reset" title="Recommencer">‚Ü∫</button>
          </div>
          <div class="demo-area" id="demo-area">
            <svg class="demo-svg" id="demo-svg"></svg>
          </div>
        </div>

        <div class="demo-panel">
          <h4>Mode d'emploi</h4>
          <div class="demo-how">
            <p><strong>+ Vignette</strong> ‚Äî ajoutez vos id√©es au canvas</p>
            <p><strong>D√âVELOPPER</strong> ‚Äî le LLM propose des id√©es connect√©es</p>
            <p><strong>RELIER</strong> ‚Äî connecte les vignettes orphelines</p>
            <p class="demo-how-o2">La jauge <strong>O‚ÇÇ</strong> baisse quand les id√©es convergent. Sous 30 ‚Üí <strong>friction</strong> inject√©e.</p>
          </div>

          <h4 style="margin-top: 1.5rem;">Journal</h4>
          <div class="demo-log" id="demo-log"></div>

          <div class="demo-friction-alert" id="friction-alert">
            ‚ö° ZONE ASPHYXIE ‚Äî FRICTION INJECT√âE
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       SECTION BETA KAIROS ‚Äî D√âSACTIV√âE TEMPORAIREMENT
       En attente de la d√©mo simplifi√©e (sans API) pour remplacer l'iframe.
       Ne pas supprimer ‚Äî le code sera r√©activ√© ou adapt√© ult√©rieurement.
       ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <!--
  <section id="essayer">
    <div class="container">
      <h2>Essayer KAIROS</h2>
      <p>
        Testez le vrai canvas KAIROS directement dans votre navigateur.
        Voici comment d√©marrer en 4 √©tapes.
      </p>

      <div class="guide-grid">
        <div class="guide-step">
          <div class="guide-step-number">1</div>
          <h4>Entrez votre cl√© API <span class="guide-help-btn" onclick="document.getElementById('api-key-guide').classList.toggle('hidden')" title="Comment obtenir une cl√© ?">?</span></h4>
          <p>Au chargement, une fen√™tre vous demande votre cl√©. Choisissez un provider (Claude, GPT, Gemini, DeepSeek, Grok) et collez votre cl√©. Elle reste en m√©moire uniquement ‚Äî jamais stock√©e.</p>
        </div>
        <div class="guide-step">
          <div class="guide-step-number">2</div>
          <h4>Cr√©ez des vignettes</h4>
          <p>Cliquez <strong>+ Vignette</strong> pour ajouter une id√©e. Double-cliquez dessus pour l'√©diter. Glissez-la pour la positionner. Chaque vignette est un n≈ìud de votre pens√©e.</p>
        </div>
        <div class="guide-step">
          <div class="guide-step-number">3</div>
          <h4>Lancez D√âVELOPPER</h4>
          <p>Cliquez <strong>D√âVELOPPER</strong> dans le bandeau. Le LLM analyse votre graphe et propose de nouvelles vignettes connect√©es √† vos id√©es existantes.</p>
        </div>
        <div class="guide-step">
          <div class="guide-step-number">4</div>
          <h4>Observez la jauge O‚ÇÇ</h4>
          <p>La barre en haut mesure la vitalit√© de votre pens√©e. Si elle descend sous 30, KAIROS injecte une <strong>friction</strong> ‚Äî une contradiction pour relancer l'exploration.</p>
        </div>
      </div>

      <div id="api-key-guide" class="api-key-guide hidden">
        <h4>Comment obtenir une cl√© API ?</h4>
        <p>Une cl√© API vous permet d'utiliser un mod√®le de langage directement. Chaque provider offre un acc√®s gratuit ou payant √† l'usage.</p>
        <div class="api-key-providers">
          <div class="api-key-provider">
            <strong>Claude (Anthropic)</strong>
            <ol>
              <li>Cr√©ez un compte sur <a href="https://console.anthropic.com" target="_blank" rel="noopener">console.anthropic.com</a></li>
              <li>Allez dans <em>API Keys</em> et cliquez <em>Create Key</em></li>
              <li>Copiez la cl√© (commence par <code>sk-ant-</code>)</li>
            </ol>
            <span class="api-key-model">Mod√®le recommand√© : claude-sonnet-4-20250514</span>
          </div>
          <div class="api-key-provider">
            <strong>GPT (OpenAI)</strong>
            <ol>
              <li>Cr√©ez un compte sur <a href="https://platform.openai.com" target="_blank" rel="noopener">platform.openai.com</a></li>
              <li>Allez dans <em>API keys</em> et cliquez <em>Create new secret key</em></li>
              <li>Copiez la cl√© (commence par <code>sk-</code>)</li>
            </ol>
            <span class="api-key-model">Mod√®le recommand√© : gpt-4o</span>
          </div>
          <div class="api-key-provider">
            <strong>Gemini (Google)</strong>
            <ol>
              <li>Allez sur <a href="https://aistudio.google.com/apikey" target="_blank" rel="noopener">aistudio.google.com/apikey</a></li>
              <li>Cliquez <em>Create API key</em></li>
              <li>Copiez la cl√© (commence par <code>AIza</code>)</li>
            </ol>
            <span class="api-key-model">Mod√®le recommand√© : gemini-2.0-flash</span>
          </div>
          <div class="api-key-provider">
            <strong>DeepSeek</strong>
            <ol>
              <li>Cr√©ez un compte sur <a href="https://platform.deepseek.com" target="_blank" rel="noopener">platform.deepseek.com</a></li>
              <li>Allez dans <em>API Keys</em> et cr√©ez une cl√©</li>
              <li>Copiez la cl√©</li>
            </ol>
            <span class="api-key-model">Mod√®le recommand√© : deepseek-chat</span>
          </div>
        </div>
        <p class="api-key-cost">La plupart des providers offrent des cr√©dits gratuits au d√©part. Une session KAIROS co√ªte typiquement quelques centimes.</p>
      </div>

      <div class="guide-tips">
        <div class="guide-tip"><strong>RELIER</strong> ‚Äî connecte les id√©es orphelines entre elles</div>
        <div class="guide-tip"><strong>Clic droit</strong> sur une vignette ‚Äî menu contextuel (supprimer, connecter, ancre)</div>
        <div class="guide-tip"><strong>Ctrl+Z / Ctrl+Y</strong> ‚Äî annuler / r√©tablir</div>
        <div class="guide-tip"><strong>Molette</strong> ‚Äî zoomer / d√©zoomer le canvas</div>
      </div>

      <p class="essayer-note">
        Session √©ph√©m√®re ‚Äî rien n'est sauvegard√©. Votre cl√© API reste en m√©moire uniquement.
      </p>

      <div class="kairos-iframe-wrapper">
        <iframe
          id="kairos-iframe"
          src="https://app.mecanique-invisible.com"
          sandbox="allow-scripts allow-same-origin"
          title="KAIROS ‚Äî Canvas de cartographie cognitive"
          loading="lazy"
        ></iframe>
      </div>
    </div>
  </section>
  -->

  <!-- Cas d'usage -->
  <section id="usecases">
    <div class="container">
      <h2>Pour Qui ?</h2>
      <p>
        KAIROS s'adresse √† ceux qui utilisent les LLM pour r√©fl√©chir,
        pas seulement pour produire.
      </p>

      <div class="usecases-grid">
        <div class="usecase-card">
          <div class="usecase-icon">üî¨</div>
          <h4>Chercheurs</h4>
          <p>Explorer des hypoth√®ses sans tomber dans la confirmation bias</p>
        </div>

        <div class="usecase-card">
          <div class="usecase-icon">üé®</div>
          <h4>Cr√©atifs</h4>
          <p>Brainstormer sans tourner en rond sur les m√™mes id√©es</p>
        </div>

        <div class="usecase-card">
          <div class="usecase-icon">üß†</div>
          <h4>Philosophes</h4>
          <p>Pousser une r√©flexion au-del√† de l'accord confortable</p>
        </div>

        <div class="usecase-card">
          <div class="usecase-icon">üìö</div>
          <h4>√âtudiants</h4>
          <p>Apprendre √† penser contre soi-m√™me</p>
        </div>
      </div>

      <div class="quote-block" style="margin-top: 3rem; text-align: center;">
        "KAIROS n'est pas un outil de productivit√©. C'est un outil de pens√©e."
      </div>
    </div>
  </section>

  <!-- Vision / Roadmap -->
  <section id="vision">
    <div class="container">
      <h2>Vision & Roadmap</h2>
      <p>
        KAIROS est en d√©veloppement actif. Voici o√π nous en sommes et o√π nous allons.
      </p>

      <div class="roadmap">
        <div class="roadmap-item done">
          <div class="phase">‚úì Fondations</div>
          <h4>Canvas & Modes</h4>
          <ul>
            <li>Canvas interactif avec vignettes et connexions</li>
            <li>Int√©gration webview LLM (Claude, ChatGPT, Gemini)</li>
            <li>Mode Assist√© (D√âVELOPPER, RELIER, SYNTH√âTISER)</li>
            <li>Mode Autonome avec gate d'intention</li>
            <li>D√©tection de circularit√© et injection de friction</li>
            <li>D√©tection d'attracteurs cognitifs</li>
          </ul>
        </div>

        <div class="roadmap-item done">
          <div class="phase">‚úì Session 5-6 (f√©v. 2026)</div>
          <h4>Oxyg√®ne, Multi-canvas & Th√®mes</h4>
          <ul>
            <li>Jauge Oxyg√®ne (5 signaux, score 0-100, 3 zones)</li>
            <li>Multi-canvas : gestion de plusieurs graphes</li>
            <li>4 th√®mes visuels (Obsidian, Porcelain, Aurora, Kraft)</li>
            <li>Migration API directe (Claude, GPT, Gemini sans webview)</li>
            <li>Synth√®ses structur√©es (format 3 blocs)</li>
            <li>D√âVELOPPER cr√©e vignettes ET connexions</li>
          </ul>
        </div>

        <div class="roadmap-item current">
          <div class="phase">‚Üí En cours</div>
          <h4>Session 7 ‚Äî Raffinement</h4>
          <ul>
            <li>Onglets canvas avec provider par onglet</li>
            <li>Calibration fine de la jauge Oxyg√®ne</li>
            <li>Syst√®me de postures adaptatif</li>
          </ul>
        </div>

        <div class="roadmap-item future">
          <div class="phase">‚óá √Ä venir</div>
          <h4>Intelligence Contextuelle</h4>
          <ul>
            <li>Slider de friction personnalisable</li>
            <li>Analyse s√©mantique avanc√©e des vignettes</li>
            <li>Export vers formats acad√©miques</li>
          </ul>
        </div>

        <div class="roadmap-item future">
          <div class="phase">‚óá Vision long terme</div>
          <h4>√âcosyst√®me</h4>
          <ul>
            <li>Partage de canvas entre utilisateurs</li>
            <li>Biblioth√®que de "patterns de friction"</li>
            <li>API pour int√©gration dans d'autres outils</li>
            <li>Version collaborative temps r√©el</li>
          </ul>
        </div>
      </div>
    </div>
  </section>

  <!-- Documentation -->
  <section id="documentation">
    <div class="container">
      <h2>Documentation Technique</h2>
      <p>
        Documentation du projet KAIROS, synchronis√©e automatiquement depuis le repository.
      </p>

      <div class="docs-layout">
        <div class="docs-sidebar" id="docs-sidebar">
          <button class="docs-sidebar-btn active" data-doc="ARCHITECTURE">Architecture & Vision</button>
          <button class="docs-sidebar-btn" data-doc="PROMPTS-LLM">M√©triques & Prompts</button>
          <button class="docs-sidebar-btn" data-doc="ROADMAP">Roadmap & Bugs</button>
        </div>
        <div class="docs-content" id="docs-content">
          <div class="docs-loading">Chargement de la documentation...</div>
        </div>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer>
    <p>
      <strong>KAIROS</strong> ‚Äî Application Electron de cartographie cognitive
    </p>
    <p class="version">
      Version 1.0.0 | F√©vrier 2026<br>
      Concept & d√©veloppement : Florent
    </p>
    <p style="margin-top: 1.5rem;">
      <a href="index.html">‚Üê Retour au site principal</a>
    </p>
  </footer>

  <script>
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // D√âMO INTERACTIVE ‚Äî SIMULATION KAIROS
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    (function() {
      var area = document.getElementById('demo-area');
      var svg = document.getElementById('demo-svg');
      var logEl = document.getElementById('demo-log');
      var o2Fill = document.getElementById('demo-o2-fill');
      var o2ValEl = document.getElementById('demo-o2-val');
      var frictionAlert = document.getElementById('friction-alert');
      if (!area) return;

      // ‚îÄ‚îÄ State ‚îÄ‚îÄ
      var vignettes = [];
      var conns = [];
      var o2 = 50;
      var nextId = 0;
      var devRound = 0;
      var frictionDone = false;
      var userIdx = 0;

      // ‚îÄ‚îÄ Pools ‚îÄ‚îÄ
      var userIdeas = [
        "L'IA peut-elle √™tre consciente ?",
        "L'√©motion pr√©c√®de la raison",
        "La m√©moire reconstruit le souvenir",
        "Le langage structure la pens√©e",
        "L'intuition : savoir sans comprendre",
        "Le libre arbitre existe-t-il ?",
        "L'attention est une ressource limit√©e"
      ];

      var devPool = [
        { texts: [
          { t: "Hard problem : pourquoi y a-t-il de l'exp√©rience ?", tags: ["#philo"] },
          { t: "Qualia : irr√©ductible exp√©rience subjective", tags: ["#philo", "#neuro"] }
        ], delta: +8 },
        { texts: [
          { t: "Plasticit√© synaptique et r√©organisation c√©r√©brale", tags: ["#neuro", "#apprentissage"] },
          { t: "Embodied cognition : penser avec le corps", tags: ["#embodiment"] }
        ], delta: +5 },
        { texts: [
          { t: "Le r√©seau neuronal produit la conscience", tags: ["#neuro"] }
        ], delta: -20, warn: "‚Üª Redondance ‚Äî territoire d√©j√† explor√©" },
        { texts: [
          { t: "La conscience √©merge des connexions neuronales", tags: ["#neuro"] }
        ], delta: -25, warn: "‚è∏ Convergence excessive ‚Äî O‚ÇÇ en chute" },
        { texts: [
          { t: "L'art comme cognition non-verbale", tags: ["#art", "#rupture"] },
          { t: "La m√©ditation alt√®re la structure c√©r√©brale", tags: ["#contemplation"] }
        ], delta: +10 }
      ];

      var frictionTexts = [
        "Et si la conscience n'√©tait qu'une illusion r√©trospective ?",
        "Penser sans langage ‚Äî est-ce encore penser ?",
        "L'IA met en crise notre d√©finition de la pens√©e"
      ];

      // ‚îÄ‚îÄ Helpers ‚îÄ‚îÄ
      function rndPos() { return 0.08 + Math.random() * 0.72; }

      function addV(text, rx, ry, tags, isFric) {
        var w = area.offsetWidth || 600;
        var h = area.offsetHeight || 400;
        var v = {
          id: nextId++, text: text, tags: tags || [],
          x: rx * (w - 180) + 10,
          y: ry * (h - 70) + 10,
          isFriction: !!isFric
        };
        vignettes.push(v);
        return v;
      }

      function addConn(fromId, toId, isFric) {
        conns.push({ from: fromId, to: toId, isFriction: !!isFric });
      }

      function clamp(val) { return Math.max(0, Math.min(100, val)); }

      function addLog(text, type) {
        var e = document.createElement('div');
        e.className = 'demo-log-entry' + (type ? ' ' + type : '');
        e.textContent = text;
        logEl.prepend(e);
        while (logEl.children.length > 12) logEl.lastChild.remove();
      }

      // ‚îÄ‚îÄ Render ‚îÄ‚îÄ
      function render() {
        area.querySelectorAll('.demo-vignette').forEach(function(el) { el.remove(); });
        vignettes.forEach(function(v) {
          var el = document.createElement('div');
          el.className = 'demo-vignette' + (v.isFriction ? ' friction' : '');
          el.setAttribute('data-id', v.id);
          el.style.left = v.x + 'px';
          el.style.top = v.y + 'px';

          var span = document.createElement('span');
          span.textContent = v.text;
          el.appendChild(span);

          if (v.tags && v.tags.length) {
            var tagDiv = document.createElement('div');
            tagDiv.className = 'vtags';
            v.tags.forEach(function(t) {
              var s = document.createElement('span');
              s.className = 'vtag';
              s.textContent = t;
              tagDiv.appendChild(s);
            });
            el.appendChild(tagDiv);
          }
          area.appendChild(el);
        });
        updateO2();
        // Delay SVG rendering to ensure DOM layout is complete
        requestAnimationFrame(renderConns);
      }

      function renderConns() {
        // Set SVG viewBox to match area dimensions
        var w = area.offsetWidth;
        var h = area.offsetHeight;
        svg.setAttribute('viewBox', '0 0 ' + w + ' ' + h);
        svg.setAttribute('width', w);
        svg.setAttribute('height', h);
        // Clear existing lines
        while (svg.firstChild) svg.removeChild(svg.firstChild);
        conns.forEach(function(c) {
          var fv = vignettes.find(function(v) { return v.id === c.from; });
          var tv = vignettes.find(function(v) { return v.id === c.to; });
          if (!fv || !tv) return;
          var fe = area.querySelector('[data-id="' + c.from + '"]');
          var te = area.querySelector('[data-id="' + c.to + '"]');
          if (!fe || !te) return;
          var line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
          line.setAttribute('x1', fv.x + fe.offsetWidth / 2);
          line.setAttribute('y1', fv.y + fe.offsetHeight / 2);
          line.setAttribute('x2', tv.x + te.offsetWidth / 2);
          line.setAttribute('y2', tv.y + te.offsetHeight / 2);
          if (c.isFriction) line.classList.add('friction-line');
          svg.appendChild(line);
        });
      }

      function updateO2() {
        o2 = clamp(o2);
        o2Fill.style.width = o2 + '%';
        o2ValEl.textContent = o2;
        var color = o2 > 50 ? 'var(--accent-green)' :
                    o2 >= 30 ? 'var(--accent-orange)' : 'var(--accent-red)';
        o2Fill.style.background = color;
        o2ValEl.style.color = color;
      }

      var MAX_VIGNETTES = 12;

      function checkLimits() {
        var addBtn = document.getElementById('demo-btn-add');
        var devBtn = document.getElementById('demo-btn-dev');
        if (vignettes.length >= MAX_VIGNETTES) {
          addBtn.disabled = true;
          devBtn.disabled = true;
          addBtn.title = 'Limite atteinte';
          devBtn.title = 'Limite atteinte';
          if (!logEl.querySelector('.demo-limit-msg')) {
            var e = document.createElement('div');
            e.className = 'demo-log-entry success demo-limit-msg';
            e.textContent = '‚úì D√©mo compl√®te ‚Äî essayez le vrai canvas ci-dessous !';
            logEl.prepend(e);
          }
        }
      }

      // ‚îÄ‚îÄ Actions ‚îÄ‚îÄ
      function userAdd() {
        if (vignettes.length >= MAX_VIGNETTES) return;
        var text = userIdeas[userIdx % userIdeas.length];
        userIdx++;
        addV(text, rndPos(), rndPos());
        o2 = clamp(o2 + 3);
        addLog('+ Vignette ajout√©e', 'success');
        render();
        checkLimits();
      }

      function developper() {
        if (vignettes.length >= MAX_VIGNETTES) return;
        var btn = document.getElementById('demo-btn-dev');
        btn.textContent = '‚è≥ R√©flexion‚Ä¶';
        btn.disabled = true;

        setTimeout(function() {
          var round = Math.min(devRound, devPool.length - 1);
          var pool = devPool[round];
          var src = vignettes[Math.floor(Math.random() * vignettes.length)];

          pool.texts.forEach(function(item) {
            if (vignettes.length >= MAX_VIGNETTES) return;
            var v = addV(item.t, rndPos(), rndPos(), item.tags);
            if (src) addConn(src.id, v.id);
          });

          o2 = clamp(o2 + pool.delta);
          if (pool.warn) {
            addLog(pool.warn, 'warn');
          } else {
            addLog('D√âVELOPPER ‚Üí ' + pool.texts.length + ' vignette(s) connect√©e(s)', 'success');
          }

          devRound++;
          render();

          if (o2 < 30 && !frictionDone) triggerFriction();

          btn.textContent = 'D√âVELOPPER';
          btn.disabled = false;
          checkLimits();
        }, 900);
      }

      function relier() {
        var connected = {};
        conns.forEach(function(c) { connected[c.from] = true; connected[c.to] = true; });
        var orphans = vignettes.filter(function(v) { return !connected[v.id]; });

        if (orphans.length >= 2) {
          var count = 0;
          for (var i = 0; i < orphans.length - 1; i += 2) {
            addConn(orphans[i].id, orphans[i + 1].id);
            count++;
          }
          o2 = clamp(o2 + 3);
          addLog('RELIER ‚Üí ' + count + ' connexion(s) cr√©√©e(s)', 'success');
        } else {
          addLog('Aucun orphelin √† connecter', '');
        }
        render();
      }

      function triggerFriction() {
        frictionDone = true;
        frictionAlert.classList.add('show');
        addLog('‚ö° ZONE ASPHYXIE ‚Äî FRICTION !', 'danger');

        setTimeout(function() {
          var text = frictionTexts[Math.floor(Math.random() * frictionTexts.length)];
          var v = addV(text, 0.25 + Math.random() * 0.4, 0.2 + Math.random() * 0.4, ['#friction'], true);
          var target = vignettes[Math.floor(Math.random() * (vignettes.length - 1))];
          if (target) addConn(v.id, target.id, true);

          o2 = clamp(o2 + 20);
          addLog('Friction accept√©e ‚Äî O‚ÇÇ +20', 'success');
          render();
          setTimeout(function() { frictionAlert.classList.remove('show'); }, 2500);
        }, 700);
      }

      function resetAll() {
        vignettes = []; conns = []; o2 = 50; nextId = 0;
        devRound = 0; frictionDone = false; userIdx = 0;
        logEl.innerHTML = '';
        frictionAlert.classList.remove('show');
        init();
      }

      // ‚îÄ‚îÄ Drag & Drop ‚îÄ‚îÄ
      var dragEl = null, dragOff = { x: 0, y: 0 };

      area.addEventListener('pointerdown', function(e) {
        var el = e.target.closest('.demo-vignette');
        if (!el) return;
        dragEl = el;
        var rect = el.getBoundingClientRect();
        dragOff.x = e.clientX - rect.left;
        dragOff.y = e.clientY - rect.top;
        el.setPointerCapture(e.pointerId);
        el.classList.add('dragging');
      });

      area.addEventListener('pointermove', function(e) {
        if (!dragEl) return;
        var areaRect = area.getBoundingClientRect();
        var x = e.clientX - areaRect.left - dragOff.x;
        var y = e.clientY - areaRect.top - dragOff.y;
        dragEl.style.left = x + 'px';
        dragEl.style.top = y + 'px';
        var id = parseInt(dragEl.getAttribute('data-id'));
        var v = vignettes.find(function(v) { return v.id === id; });
        if (v) { v.x = x; v.y = y; }
        renderConns();
      });

      area.addEventListener('pointerup', function() {
        if (dragEl) { dragEl.classList.remove('dragging'); dragEl = null; }
      });

      // ‚îÄ‚îÄ Bind ‚îÄ‚îÄ
      document.getElementById('demo-btn-add').addEventListener('click', userAdd);
      document.getElementById('demo-btn-dev').addEventListener('click', developper);
      document.getElementById('demo-btn-rel').addEventListener('click', relier);
      document.getElementById('demo-btn-reset').addEventListener('click', resetAll);

      // ‚îÄ‚îÄ Init ‚îÄ‚îÄ
      function init() {
        addV('La conscience √©merge du cerveau', 0.35, 0.35, ['#initial']);
        addLog('Canvas initialis√©', 'success');
        render();
      }
      init();
    })();

    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // NAVIGATION & ANIMATIONS
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

    // Smooth scroll for nav links
    document.querySelectorAll('nav a').forEach(link => {
      link.addEventListener('click', (e) => {
        const href = link.getAttribute('href');
        if (!href || !href.startsWith('#')) return;
        e.preventDefault();
        const target = document.querySelector(href);
        if (target) target.scrollIntoView({ behavior: 'smooth' });
      });
    });

    // Intersection Observer for fade-in animations
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('fade-in');
        }
      });
    }, { threshold: 0.1 });

    document.querySelectorAll('section > .container').forEach(el => {
      observer.observe(el);
    });

    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // IFRAME KAIROS ‚Äî COMMUNICATION (D√âSACTIV√â)
    // Section beta comment√©e ‚Äî ce listener sera r√©activ√© si besoin.
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    /*
    const kairosIframe = document.getElementById('kairos-iframe');
    if (kairosIframe) {
      const KAIROS_ORIGIN = 'https://app.mecanique-invisible.com';

      window.addEventListener('message', (event) => {
        if (event.origin !== KAIROS_ORIGIN) return;
        if (!event.data || typeof event.data.type !== 'string') return;

        if (event.data.type === 'kairos:ready') {
          kairosIframe.contentWindow.postMessage({
            type: 'kairos:config',
            theme: 'obsidian'
          }, KAIROS_ORIGIN);
        }

        if (event.data.type === 'kairos:nodeCount') {
          console.log('KAIROS: ' + event.data.count + ' vignettes');
        }

        if (event.data.type === 'kairos:error') {
          console.warn('KAIROS error:', event.data.message);
        }
      });
    }
    */
  </script>

  <!-- marked.js for Markdown rendering -->
  <script src="https://cdn.jsdelivr.net/npm/marked@15.0.12/marked.min.js"
          integrity="sha384-948ahk4ZmxYVYOc+rxN1H2gM1EJ2Duhp7uHtZ4WSLkV4Vtx5MUqnV+l7u9B+jFv+"
          crossorigin="anonymous"></script>
  <!-- DOMPurify for sanitizing rendered Markdown -->
  <script src="https://cdn.jsdelivr.net/npm/dompurify@3.3.1/dist/purify.min.js"
          integrity="sha384-80VlBZnyAwkkqtSfg5NhPyZff6nU4K/qniLBL8Jnm4KDv6jZhLiYtJbhglg/i9ww"
          crossorigin="anonymous"></script>
  <script>
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // DOCUMENTATION VIEWER
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    const docsContent = document.getElementById('docs-content');
    const docsSidebar = document.getElementById('docs-sidebar');
    let currentDoc = 'ARCHITECTURE';

    async function loadDoc(name) {
      docsContent.innerHTML = '<div class="docs-loading">Chargement...</div>';
      currentDoc = name;

      // Update active button
      docsSidebar.querySelectorAll('.docs-sidebar-btn').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.doc === name);
      });

      try {
        const response = await fetch('docs/' + name + '.md');
        if (!response.ok) throw new Error('Document introuvable');
        const markdown = await response.text();
        docsContent.innerHTML = DOMPurify.sanitize(marked.parse(markdown));
      } catch (e) {
        const errorDiv = document.createElement('div');
        errorDiv.className = 'docs-error';
        errorDiv.textContent = 'Impossible de charger le document.';
        const detail = document.createElement('small');
        detail.textContent = e.message;
        errorDiv.appendChild(document.createElement('br'));
        errorDiv.appendChild(detail);
        docsContent.replaceChildren(errorDiv);
      }
    }

    // Click handlers on sidebar buttons
    docsSidebar.addEventListener('click', (e) => {
      const btn = e.target.closest('.docs-sidebar-btn');
      if (btn && btn.dataset.doc) {
        loadDoc(btn.dataset.doc);
      }
    });

    // Load default doc when section becomes visible (lazy load)
    const docsObserver = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          loadDoc(currentDoc);
          docsObserver.disconnect();
        }
      });
    }, { threshold: 0.1 });
    docsObserver.observe(document.getElementById('documentation'));
  </script>
</body>
</html>
